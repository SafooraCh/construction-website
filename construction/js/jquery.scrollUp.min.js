/*!
 * scrollup v2.4.1
 * Url: http://markgoodyear.com/labs/scrollup/
 * Copyright (c) Mark Goodyear
 * License: MIT
 */

(function ($, window, document) {
  "use strict";

  $.fn.scrollUp = function (options) {
    if (!$.data(document.body, "scrollUp")) {
      $.data(document.body, "scrollUp", true);
      $.fn.scrollUp.init(options);
    }
  };

  $.fn.scrollUp.init = function (userOptions) {
    var showFn,
      hideFn,
      speed,
      trigger,
      offset,
      scrollTarget,
      active,
      settings = ($.fn.scrollUp.settings = $.extend(
        {},
        $.fn.scrollUp.defaults,
        userOptions
      )),
      visible = false;

    trigger = settings.scrollTrigger
      ? $(settings.scrollTrigger)
      : $("<a/>", {
          id: settings.scrollName,
          href: "#top",
        });

    if (settings.scrollTitle) {
      trigger.attr("title", settings.scrollTitle);
    }

    trigger.appendTo("body");

    if (!settings.scrollImg && !settings.scrollTrigger) {
      trigger.html(settings.scrollText);
    }

    trigger.css({
      display: "none",
      position: "fixed",
      zIndex: settings.zIndex,
    });

    if (settings.activeOverlay) {
      $("<div/>", { id: settings.scrollName + "-active" })
        .css({
          position: "absolute",
          top: settings.scrollDistance + "px",
          width: "100%",
          borderTop: "1px dotted " + settings.activeOverlay,
          zIndex: settings.zIndex,
        })
        .appendTo("body");
    }

    switch (settings.animation) {
      case "fade":
        showFn = "fadeIn";
        hideFn = "fadeOut";
        speed = settings.animationSpeed;
        break;
      case "slide":
        showFn = "slideDown";
        hideFn = "slideUp";
        speed = settings.animationSpeed;
        break;
      default:
        showFn = "show";
        hideFn = "hide";
        speed = 0;
    }

    offset =
      settings.scrollFrom === "top"
        ? settings.scrollDistance
        : $(document).height() - $(window).height() - settings.scrollDistance;

    $(window).scroll(function () {
      if ($(window).scrollTop() > offset) {
        if (!visible) {
          trigger[showFn](speed);
          visible = true;
        }
      } else {
        if (visible) {
          trigger[hideFn](speed);
          visible = false;
        }
      }
    });

    if (settings.scrollTarget) {
      if (typeof settings.scrollTarget === "number") {
        scrollTarget = settings.scrollTarget;
      } else if (typeof settings.scrollTarget === "string") {
        scrollTarget = Math.floor($(settings.scrollTarget).offset().top);
      }
    } else {
      scrollTarget = 0;
    }

    trigger.click(function (event) {
      event.preventDefault();
      $("html, body").animate(
        { scrollTop: scrollTarget },
        settings.scrollSpeed,
        settings.easingType
      );
    });
  };

  $.fn.scrollUp.defaults = {
    scrollName: "scrollUp",
    scrollDistance: 300,
    scrollFrom: "top",
    scrollSpeed: 300,
    easingType: "linear",
    animation: "fade",
    animationSpeed: 200,
    scrollTrigger: false,
    scrollTarget: false,
    scrollText: "Scroll to top",
    scrollTitle: false,
    scrollImg: false,
    activeOverlay: false,
    zIndex: 2147483647,
  };

  $.fn.scrollUp.destroy = function (handler) {
    $.removeData(document.body, "scrollUp");
    $("#" + $.fn.scrollUp.settings.scrollName).remove();
    $("#" + $.fn.scrollUp.settings.scrollName + "-active").remove();

    if ($.fn.jquery.split(".")[1] >= 7) {
      $(window).off("scroll", handler);
    } else {
      $(window).unbind("scroll", handler);
    }
  };

  $.scrollUp = $.fn.scrollUp;
})(jQuery, window, document);
